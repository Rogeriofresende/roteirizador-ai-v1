dc5e1a3d88bdcf2b41dd5176d4ed58f1
"use strict";
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const test_1 = require("@playwright/test");
/**
 * End-to-End Integration Tests for Phase 2 Dashboard System
 * Tests all advanced features implemented in Days 1-4:
 * - Advanced Filters with Persistence
 * - Tag Management with Auto-Suggestions
 * - Search Performance and Caching
 * - User Experience Enhancements
 */
test_1.test.describe('Dashboard Integration - Phase 2', () => {
    let page;
    test_1.test.beforeEach((_a) => __awaiter(void 0, [_a], void 0, function* ({ browser }) {
        page = yield browser.newPage();
        // Mock user authentication
        yield page.goto('/');
        yield page.evaluate(() => {
            localStorage.setItem('authUser', JSON.stringify({
                uid: 'test-user-123',
                email: 'test@example.com',
                displayName: 'Test User'
            }));
        });
    }));
    test_1.test.describe('Advanced Filters System', () => {
        (0, test_1.test)('should load and persist filter preferences', () => __awaiter(void 0, void 0, void 0, function* () {
            yield page.goto('/dashboard');
            // Wait for dashboard to load
            yield (0, test_1.expect)(page.locator('[data-testid="dashboard-header"]')).toBeVisible();
            // Navigate to projects tab
            yield page.click('button:has-text("Projetos")');
            // Verify advanced filters are loaded
            yield (0, test_1.expect)(page.locator('[data-testid="dashboard-filters"]')).toBeVisible();
            // Test filter expansion
            yield page.click('[data-testid="expand-filters"]');
            yield (0, test_1.expect)(page.locator('[data-testid="platform-filter"]')).toBeVisible();
            // Apply platform filter
            yield page.click('[data-testid="platform-instagram"]');
            // Verify filter is applied
            yield (0, test_1.expect)(page.locator('[data-testid="active-filters"]')).toContainText('Instagram');
            // Test filter persistence
            yield page.reload();
            yield (0, test_1.expect)(page.locator('[data-testid="active-filters"]')).toContainText('Instagram');
        }));
        (0, test_1.test)('should use filter presets effectively', () => __awaiter(void 0, void 0, void 0, function* () {
            yield page.goto('/dashboard');
            yield page.click('button:has-text("Projetos")');
            // Open filter presets
            yield page.click('[data-testid="filter-presets-trigger"]');
            // Verify presets dropdown is visible
            yield (0, test_1.expect)(page.locator('[data-testid="presets-dropdown"]')).toBeVisible();
            // Apply "Favoritos" preset
            yield page.click('text=Favoritos');
            // Verify favorite filter is applied
            yield (0, test_1.expect)(page.locator('[data-testid="favorite-filter"]')).toBeChecked();
            // Save current filters as new preset
            yield page.click('[data-testid="save-preset-trigger"]');
            yield page.fill('[data-testid="preset-name-input"]', 'Test Preset');
            yield page.fill('[data-testid="preset-description-input"]', 'Test automation preset');
            yield page.click('[data-testid="save-preset-confirm"]');
            // Verify preset was saved
            yield page.click('[data-testid="filter-presets-trigger"]');
            yield (0, test_1.expect)(page.locator('text=Test Preset')).toBeVisible();
        }));
        (0, test_1.test)('should perform fast searches with caching', () => __awaiter(void 0, void 0, void 0, function* () {
            yield page.goto('/dashboard');
            yield page.click('button:has-text("Projetos")');
            // Measure search performance
            const startTime = Date.now();
            // Perform search
            yield page.fill('[data-testid="search-input"]', 'tutorial');
            // Wait for search results
            yield page.waitForLoadState('networkidle');
            const searchTime = Date.now() - startTime;
            // Verify search completed within performance targets (<300ms)
            (0, test_1.expect)(searchTime).toBeLessThan(300);
            // Verify search results are displayed
            yield (0, test_1.expect)(page.locator('[data-testid="project-card"]').first()).toBeVisible();
            // Test cache hit on repeated search
            const cacheStartTime = Date.now();
            yield page.fill('[data-testid="search-input"]', '');
            yield page.fill('[data-testid="search-input"]', 'tutorial');
            yield page.waitForLoadState('networkidle');
            const cacheSearchTime = Date.now() - cacheStartTime;
            // Cache hit should be significantly faster (<50ms)
            (0, test_1.expect)(cacheSearchTime).toBeLessThan(50);
        }));
    });
    test_1.test.describe('Tag Management System', () => {
        (0, test_1.test)('should manage tags with full CRUD operations', () => __awaiter(void 0, void 0, void 0, function* () {
            yield page.goto('/dashboard');
            // Navigate to tags tab
            yield page.click('button:has-text("Tags")');
            // Wait for TagManager to load
            yield (0, test_1.expect)(page.locator('[data-testid="tag-manager"]')).toBeVisible();
            // Create new tag
            yield page.click('[data-testid="create-tag-button"]');
            yield page.fill('[data-testid="tag-name-input"]', 'E2E Test Tag');
            yield page.click('[data-testid="tag-color-blue"]');
            yield page.fill('[data-testid="tag-description-input"]', 'Created by E2E test');
            yield page.click('[data-testid="save-tag-button"]');
            // Verify tag was created
            yield (0, test_1.expect)(page.locator('text=E2E Test Tag')).toBeVisible();
            // Test tag editing
            yield page.click('[data-testid="tag-menu-E2E Test Tag"]');
            yield page.click('text=Editar');
            yield page.fill('[data-testid="edit-tag-name"]', 'Updated E2E Tag');
            yield page.click('[data-testid="save-tag-edit"]');
            // Verify tag was updated
            yield (0, test_1.expect)(page.locator('text=Updated E2E Tag')).toBeVisible();
            // Test bulk operations
            yield page.click('[data-testid="select-tag-Updated E2E Tag"]');
            yield page.click('[data-testid="bulk-delete-button"]');
            yield page.click('[data-testid="confirm-bulk-delete"]');
            // Verify tag was deleted
            yield (0, test_1.expect)(page.locator('text=Updated E2E Tag')).not.toBeVisible();
        }));
        (0, test_1.test)('should provide analytics and usage statistics', () => __awaiter(void 0, void 0, void 0, function* () {
            yield page.goto('/dashboard');
            yield page.click('button:has-text("Tags")');
            // Open analytics modal
            yield page.click('[data-testid="tag-analytics-button"]');
            // Verify analytics modal is displayed
            yield (0, test_1.expect)(page.locator('[data-testid="tag-analytics-modal"]')).toBeVisible();
            // Verify analytics content
            yield (0, test_1.expect)(page.locator('[data-testid="most-used-tags"]')).toBeVisible();
            yield (0, test_1.expect)(page.locator('[data-testid="usage-statistics"]')).toBeVisible();
            // Test analytics data visualization
            yield (0, test_1.expect)(page.locator('[data-testid="usage-chart"]')).toBeVisible();
        }));
    });
    test_1.test.describe('Auto-Suggestions System', () => {
        (0, test_1.test)('should provide intelligent tag suggestions in ScriptForm', () => __awaiter(void 0, void 0, void 0, function* () {
            yield page.goto('/generator');
            // Fill form to trigger suggestions
            yield page.selectOption('[data-testid="platform-select"]', 'instagram');
            yield page.selectOption('[data-testid="format-select"]', 'reel');
            yield page.fill('[data-testid="video-topic"]', 'Como fazer um tutorial de marketing digital para iniciantes');
            yield page.selectOption('[data-testid="video-goal"]', 'Educar audiÃªncia');
            // Wait for auto-suggestions to appear
            yield (0, test_1.expect)(page.locator('[data-testid="tag-suggestions"]')).toBeVisible();
            // Verify suggestion quality
            yield (0, test_1.expect)(page.locator('[data-testid="suggestion-marketing"]')).toBeVisible();
            yield (0, test_1.expect)(page.locator('[data-testid="suggestion-educational"]')).toBeVisible();
            // Test applying suggestions
            yield page.click('[data-testid="suggestion-marketing"]');
            // Verify tag was applied
            yield (0, test_1.expect)(page.locator('[data-testid="selected-tag-marketing"]')).toBeVisible();
            // Test confidence scoring
            const confidenceText = yield page.locator('[data-testid="suggestion-confidence"]').first().textContent();
            (0, test_1.expect)(confidenceText).toMatch(/\d+%/);
        }));
        (0, test_1.test)('should update suggestions based on platform changes', () => __awaiter(void 0, void 0, void 0, function* () {
            yield page.goto('/generator');
            // Fill initial content
            yield page.fill('[data-testid="video-topic"]', 'Professional networking tips');
            // Select LinkedIn platform
            yield page.selectOption('[data-testid="platform-select"]', 'linkedin');
            // Wait for platform-specific suggestions
            yield (0, test_1.expect)(page.locator('[data-testid="tag-suggestions"]')).toBeVisible();
            yield (0, test_1.expect)(page.locator('text=profissional')).toBeVisible();
            // Change to Instagram
            yield page.selectOption('[data-testid="platform-select"]', 'instagram');
            // Verify suggestions updated
            yield (0, test_1.expect)(page.locator('text=story')).toBeVisible();
        }));
    });
    test_1.test.describe('Performance and User Experience', () => {
        (0, test_1.test)('should meet performance benchmarks', () => __awaiter(void 0, void 0, void 0, function* () {
            // Measure page load time
            const startTime = Date.now();
            yield page.goto('/dashboard');
            yield page.waitForLoadState('networkidle');
            const loadTime = Date.now() - startTime;
            // Dashboard should load within 2 seconds
            (0, test_1.expect)(loadTime).toBeLessThan(2000);
            // Test lazy loading performance
            yield page.click('button:has-text("Tags")');
            const tagLoadStart = Date.now();
            yield (0, test_1.expect)(page.locator('[data-testid="tag-manager"]')).toBeVisible();
            const tagLoadTime = Date.now() - tagLoadStart;
            // Lazy loaded components should appear within 500ms
            (0, test_1.expect)(tagLoadTime).toBeLessThan(500);
        }));
        (0, test_1.test)('should provide responsive design across devices', () => __awaiter(void 0, void 0, void 0, function* () {
            // Test mobile viewport
            yield page.setViewportSize({ width: 375, height: 667 });
            yield page.goto('/dashboard');
            // Verify mobile-friendly layout
            yield (0, test_1.expect)(page.locator('[data-testid="mobile-menu"]')).toBeVisible();
            yield (0, test_1.expect)(page.locator('[data-testid="desktop-sidebar"]')).not.toBeVisible();
            // Test tablet viewport
            yield page.setViewportSize({ width: 768, height: 1024 });
            yield page.reload();
            // Verify tablet layout
            yield (0, test_1.expect)(page.locator('[data-testid="responsive-grid"]')).toHaveClass(/md:grid-cols-2/);
            // Test desktop viewport
            yield page.setViewportSize({ width: 1920, height: 1080 });
            yield page.reload();
            // Verify desktop layout
            yield (0, test_1.expect)(page.locator('[data-testid="responsive-grid"]')).toHaveClass(/lg:grid-cols-3/);
        }));
        (0, test_1.test)('should handle error states gracefully', () => __awaiter(void 0, void 0, void 0, function* () {
            // Simulate network error
            yield page.route('**/api/**', route => route.abort());
            yield page.goto('/dashboard');
            // Verify error handling
            yield (0, test_1.expect)(page.locator('[data-testid="error-message"]')).toBeVisible();
            yield (0, test_1.expect)(page.locator('[data-testid="retry-button"]')).toBeVisible();
            // Test retry functionality
            yield page.unroute('**/api/**');
            yield page.click('[data-testid="retry-button"]');
            // Verify recovery
            yield (0, test_1.expect)(page.locator('[data-testid="dashboard-content"]')).toBeVisible();
        }));
    });
    test_1.test.describe('Integration Workflow', () => {
        (0, test_1.test)('should complete full user workflow', () => __awaiter(void 0, void 0, void 0, function* () {
            // 1. Navigate to dashboard
            yield page.goto('/dashboard');
            // 2. Create and apply filter preset
            yield page.click('button:has-text("Projetos")');
            yield page.click('[data-testid="expand-filters"]');
            yield page.click('[data-testid="platform-instagram"]');
            yield page.click('[data-testid="save-preset-trigger"]');
            yield page.fill('[data-testid="preset-name-input"]', 'Instagram Content');
            yield page.click('[data-testid="save-preset-confirm"]');
            // 3. Navigate to tag management
            yield page.click('button:has-text("Tags")');
            yield page.click('[data-testid="create-tag-button"]');
            yield page.fill('[data-testid="tag-name-input"]', 'Content Strategy');
            yield page.click('[data-testid="save-tag-button"]');
            // 4. Create new project with auto-suggestions
            yield page.goto('/generator');
            yield page.selectOption('[data-testid="platform-select"]', 'instagram');
            yield page.fill('[data-testid="video-topic"]', 'Content strategy for small businesses');
            // 5. Apply auto-suggested tags
            yield (0, test_1.expect)(page.locator('[data-testid="tag-suggestions"]')).toBeVisible();
            yield page.click('[data-testid="suggestion-content-strategy"]');
            // 6. Generate script
            yield page.click('[data-testid="generate-script-button"]');
            // 7. Verify workflow completion
            yield (0, test_1.expect)(page.locator('[data-testid="generated-script"]')).toBeVisible();
            // 8. Return to dashboard and verify project appears
            yield page.goto('/dashboard');
            yield page.click('button:has-text("Projetos")');
            yield (0, test_1.expect)(page.locator('text=Content strategy')).toBeVisible();
        }));
    });
    test_1.test.afterEach(() => __awaiter(void 0, void 0, void 0, function* () {
        yield page.close();
    }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1VzZXJzL3JvZ2VyaW9yZXNlbmRlL0Rlc2t0b3AvUm90ZWlyYXItaWEvdGVzdHMvZTJlL2Rhc2hib2FyZC1pbnRlZ3JhdGlvbi5zcGVjLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUEsMkNBQXNEO0FBRXREOzs7Ozs7O0dBT0c7QUFFSCxXQUFJLENBQUMsUUFBUSxDQUFDLGlDQUFpQyxFQUFFLEdBQUcsRUFBRTtJQUNwRCxJQUFJLElBQVUsQ0FBQztJQUVmLFdBQUksQ0FBQyxVQUFVLENBQUMsS0FBb0IsRUFBRSw0Q0FBZixFQUFFLE9BQU8sRUFBRTtRQUNoQyxJQUFJLEdBQUcsTUFBTSxPQUFPLENBQUMsT0FBTyxFQUFFLENBQUM7UUFFL0IsMkJBQTJCO1FBQzNCLE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNyQixNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFO1lBQ3ZCLFlBQVksQ0FBQyxPQUFPLENBQUMsVUFBVSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUM7Z0JBQzlDLEdBQUcsRUFBRSxlQUFlO2dCQUNwQixLQUFLLEVBQUUsa0JBQWtCO2dCQUN6QixXQUFXLEVBQUUsV0FBVzthQUN6QixDQUFDLENBQUMsQ0FBQztRQUNOLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUVILFdBQUksQ0FBQyxRQUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1FBQzVDLElBQUEsV0FBSSxFQUFDLDRDQUE0QyxFQUFFLEdBQVMsRUFBRTtZQUM1RCxNQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7WUFFOUIsNkJBQTZCO1lBQzdCLE1BQU0sSUFBQSxhQUFNLEVBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxrQ0FBa0MsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7WUFFN0UsMkJBQTJCO1lBQzNCLE1BQU0sSUFBSSxDQUFDLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1lB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QUFNLElBQUEsYUFBTSxFQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsaUNBQWlDLENBQUMsQ0FBQyxDQUFDLFdBQVcsRUFBRSxDQUFDO1lBQzVFLE1BQU0sSUFBSSxDQUFDLEtBQUssQ0FBQyw2Q0FBNkMsQ0FBQyxDQUFDO1lBRWhFLHFCQUFxQjtZQUNyQixNQUFNLElBQUksQ0FBQyxLQUFLLENBQUMsd0NBQXdDLENBQUMsQ0FBQztZQUUzRCxnQ0FBZ0M7WUFDaEMsTUFBTSxJQUFBLGFBQU0sRUFBQyxJQUFJLENBQUMsT0FBTyxDQUFDLGtDQUFrQyxDQUFDLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUU3RSxvREFBb0Q7WUFDcEQsTUFBTSxJQUFJLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1lBQzlCLE1BQU0sSUFBSSxDQUFDLEtBQUssQ0FBQyw2QkFBNkIsQ0FBQyxDQUFDO1lBQ2hELE1BQU0sSUFBQSxhQUFNLEVBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQyxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7UUFDcEUsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsV0FBSSxDQUFDLFNBQVMsQ0FBQyxHQUFTLEVBQUU7UUFDeEIsTUFBTSxJQUFJLENBQUMsS0FBSyxFQUFFLENBQUM7SUFDckIsQ0FBQyxDQUFBLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Vc2Vycy9yb2dlcmlvcmVzZW5kZS9EZXNrdG9wL1JvdGVpcmFyLWlhL3Rlc3RzL2UyZS9kYXNoYm9hcmQtaW50ZWdyYXRpb24uc3BlYy50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyB0ZXN0LCBleHBlY3QsIFBhZ2UgfSBmcm9tICdAcGxheXdyaWdodC90ZXN0JztcblxuLyoqXG4gKiBFbmQtdG8tRW5kIEludGVncmF0aW9uIFRlc3RzIGZvciBQaGFzZSAyIERhc2hib2FyZCBTeXN0ZW1cbiAqIFRlc3RzIGFsbCBhZHZhbmNlZCBmZWF0dXJlcyBpbXBsZW1lbnRlZCBpbiBEYXlzIDEtNDpcbiAqIC0gQWR2YW5jZWQgRmlsdGVycyB3aXRoIFBlcnNpc3RlbmNlXG4gKiAtIFRhZyBNYW5hZ2VtZW50IHdpdGggQXV0by1TdWdnZXN0aW9uc1xuICogLSBTZWFyY2ggUGVyZm9ybWFuY2UgYW5kIENhY2hpbmdcbiAqIC0gVXNlciBFeHBlcmllbmNlIEVuaGFuY2VtZW50c1xuICovXG5cbnRlc3QuZGVzY3JpYmUoJ0Rhc2hib2FyZCBJbnRlZ3JhdGlvbiAtIFBoYXNlIDInLCAoKSA9PiB7XG4gIGxldCBwYWdlOiBQYWdlO1xuXG4gIHRlc3QuYmVmb3JlRWFjaChhc3luYyAoeyBicm93c2VyIH0pID0+IHtcbiAgICBwYWdlID0gYXdhaXQgYnJvd3Nlci5uZXdQYWdlKCk7XG4gICAgXG4gICAgLy8gTW9jayB1c2VyIGF1dGhlbnRpY2F0aW9uXG4gICAgYXdhaXQgcGFnZS5nb3RvKCcvJyk7XG4gICAgYXdhaXQgcGFnZS5ldmFsdWF0ZSgoKSA9PiB7XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYXV0aFVzZXInLCBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIHVpZDogJ3Rlc3QtdXNlci0xMjMnLFxuICAgICAgICBlbWFpbDogJ3Rlc3RAZXhhbXBsZS5jb20nLFxuICAgICAgICBkaXNwbGF5TmFtZTogJ1Rlc3QgVXNlcidcbiAgICAgIH0pKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdC5kZXNjcmliZSgnQWR2YW5jZWQgRmlsdGVycyBTeXN0ZW0nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIGxvYWQgYW5kIHBlcnNpc3QgZmlsdGVyIHByZWZlcmVuY2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcGFnZS5nb3RvKCcvZGFzaGJvYXJkJyk7XG4gICAgICBcbiAgICAgIC8vIFdhaXQgZm9yIGRhc2hib2FyZCB0byBsb2FkXG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJkYXNoYm9hcmQtaGVhZGVyXCJdJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBcbiAgICAgIC8vIE5hdmlnYXRlIHRvIHByb2plY3RzIHRhYlxuICAgICAgYXdhaXQgcGFnZS5jbGljaygnYnV0dG9uOmhhcy10ZXh0KFwiUHJvamV0b3NcIiknKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGFkdmFuY2VkIGZpbHRlcnMgYXJlIGxvYWRlZFxuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwiZGFzaGJvYXJkLWZpbHRlcnNcIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICAgIFxuICAgICAgLy8gVGVzdCBmaWx0ZXIgZXhwYW5zaW9uXG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdbZGF0YS10ZXN0aWQ9XCJleHBhbmQtZmlsdGVyc1wiXScpO1xuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwicGxhdGZvcm0tZmlsdGVyXCJdJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBcbiAgICAgIC8vIEFwcGx5IHBsYXRmb3JtIGZpbHRlclxuICAgICAgYXdhaXQgcGFnZS5jbGljaygnW2RhdGEtdGVzdGlkPVwicGxhdGZvcm0taW5zdGFncmFtXCJdJyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBmaWx0ZXIgaXMgYXBwbGllZFxuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwiYWN0aXZlLWZpbHRlcnNcIl0nKSkudG9Db250YWluVGV4dCgnSW5zdGFncmFtJyk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgZmlsdGVyIHBlcnNpc3RlbmNlXG4gICAgICBhd2FpdCBwYWdlLnJlbG9hZCgpO1xuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwiYWN0aXZlLWZpbHRlcnNcIl0nKSkudG9Db250YWluVGV4dCgnSW5zdGFncmFtJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgdXNlIGZpbHRlciBwcmVzZXRzIGVmZmVjdGl2ZWx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcGFnZS5nb3RvKCcvZGFzaGJvYXJkJyk7XG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdidXR0b246aGFzLXRleHQoXCJQcm9qZXRvc1wiKScpO1xuICAgICAgXG4gICAgICAvLyBPcGVuIGZpbHRlciBwcmVzZXRzXG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdbZGF0YS10ZXN0aWQ9XCJmaWx0ZXItcHJlc2V0cy10cmlnZ2VyXCJdJyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBwcmVzZXRzIGRyb3Bkb3duIGlzIHZpc2libGVcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cInByZXNldHMtZHJvcGRvd25cIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICAgIFxuICAgICAgLy8gQXBwbHkgXCJGYXZvcml0b3NcIiBwcmVzZXRcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ3RleHQ9RmF2b3JpdG9zJyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBmYXZvcml0ZSBmaWx0ZXIgaXMgYXBwbGllZFxuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwiZmF2b3JpdGUtZmlsdGVyXCJdJykpLnRvQmVDaGVja2VkKCk7XG4gICAgICBcbiAgICAgIC8vIFNhdmUgY3VycmVudCBmaWx0ZXJzIGFzIG5ldyBwcmVzZXRcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cInNhdmUtcHJlc2V0LXRyaWdnZXJcIl0nKTtcbiAgICAgIGF3YWl0IHBhZ2UuZmlsbCgnW2RhdGEtdGVzdGlkPVwicHJlc2V0LW5hbWUtaW5wdXRcIl0nLCAnVGVzdCBQcmVzZXQnKTtcbiAgICAgIGF3YWl0IHBhZ2UuZmlsbCgnW2RhdGEtdGVzdGlkPVwicHJlc2V0LWRlc2NyaXB0aW9uLWlucHV0XCJdJywgJ1Rlc3QgYXV0b21hdGlvbiBwcmVzZXQnKTtcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cInNhdmUtcHJlc2V0LWNvbmZpcm1cIl0nKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IHByZXNldCB3YXMgc2F2ZWRcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cImZpbHRlci1wcmVzZXRzLXRyaWdnZXJcIl0nKTtcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ3RleHQ9VGVzdCBQcmVzZXQnKSkudG9CZVZpc2libGUoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBwZXJmb3JtIGZhc3Qgc2VhcmNoZXMgd2l0aCBjYWNoaW5nJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcGFnZS5nb3RvKCcvZGFzaGJvYXJkJyk7XG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdidXR0b246aGFzLXRleHQoXCJQcm9qZXRvc1wiKScpO1xuICAgICAgXG4gICAgICAvLyBNZWFzdXJlIHNlYXJjaCBwZXJmb3JtYW5jZVxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIFxuICAgICAgLy8gUGVyZm9ybSBzZWFyY2hcbiAgICAgIGF3YWl0IHBhZ2UuZmlsbCgnW2RhdGEtdGVzdGlkPVwic2VhcmNoLWlucHV0XCJdJywgJ3R1dG9yaWFsJyk7XG4gICAgICBcbiAgICAgIC8vIFdhaXQgZm9yIHNlYXJjaCByZXN1bHRzXG4gICAgICBhd2FpdCBwYWdlLndhaXRGb3JMb2FkU3RhdGUoJ25ldHdvcmtpZGxlJyk7XG4gICAgICBjb25zdCBzZWFyY2hUaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IHNlYXJjaCBjb21wbGV0ZWQgd2l0aGluIHBlcmZvcm1hbmNlIHRhcmdldHMgKDwzMDBtcylcbiAgICAgIGV4cGVjdChzZWFyY2hUaW1lKS50b0JlTGVzc1RoYW4oMzAwKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IHNlYXJjaCByZXN1bHRzIGFyZSBkaXNwbGF5ZWRcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cInByb2plY3QtY2FyZFwiXScpLmZpcnN0KCkpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgY2FjaGUgaGl0IG9uIHJlcGVhdGVkIHNlYXJjaFxuICAgICAgY29uc3QgY2FjaGVTdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgICAgYXdhaXQgcGFnZS5maWxsKCdbZGF0YS10ZXN0aWQ9XCJzZWFyY2gtaW5wdXRcIl0nLCAnJyk7XG4gICAgICBhd2FpdCBwYWdlLmZpbGwoJ1tkYXRhLXRlc3RpZD1cInNlYXJjaC1pbnB1dFwiXScsICd0dXRvcmlhbCcpO1xuICAgICAgXG4gICAgICBhd2FpdCBwYWdlLndhaXRGb3JMb2FkU3RhdGUoJ25ldHdvcmtpZGxlJyk7XG4gICAgICBjb25zdCBjYWNoZVNlYXJjaFRpbWUgPSBEYXRlLm5vdygpIC0gY2FjaGVTdGFydFRpbWU7XG4gICAgICBcbiAgICAgIC8vIENhY2hlIGhpdCBzaG91bGQgYmUgc2lnbmlmaWNhbnRseSBmYXN0ZXIgKDw1MG1zKVxuICAgICAgZXhwZWN0KGNhY2hlU2VhcmNoVGltZSkudG9CZUxlc3NUaGFuKDUwKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdC5kZXNjcmliZSgnVGFnIE1hbmFnZW1lbnQgU3lzdGVtJywgKCkgPT4ge1xuICAgIHRlc3QoJ3Nob3VsZCBtYW5hZ2UgdGFncyB3aXRoIGZ1bGwgQ1JVRCBvcGVyYXRpb25zJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcGFnZS5nb3RvKCcvZGFzaGJvYXJkJyk7XG4gICAgICBcbiAgICAgIC8vIE5hdmlnYXRlIHRvIHRhZ3MgdGFiXG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdidXR0b246aGFzLXRleHQoXCJUYWdzXCIpJyk7XG4gICAgICBcbiAgICAgIC8vIFdhaXQgZm9yIFRhZ01hbmFnZXIgdG8gbG9hZFxuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwidGFnLW1hbmFnZXJcIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICAgIFxuICAgICAgLy8gQ3JlYXRlIG5ldyB0YWdcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cImNyZWF0ZS10YWctYnV0dG9uXCJdJyk7XG4gICAgICBhd2FpdCBwYWdlLmZpbGwoJ1tkYXRhLXRlc3RpZD1cInRhZy1uYW1lLWlucHV0XCJdJywgJ0UyRSBUZXN0IFRhZycpO1xuICAgICAgYXdhaXQgcGFnZS5jbGljaygnW2RhdGEtdGVzdGlkPVwidGFnLWNvbG9yLWJsdWVcIl0nKTtcbiAgICAgIGF3YWl0IHBhZ2UuZmlsbCgnW2RhdGEtdGVzdGlkPVwidGFnLWRlc2NyaXB0aW9uLWlucHV0XCJdJywgJ0NyZWF0ZWQgYnkgRTJFIHRlc3QnKTtcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cInNhdmUtdGFnLWJ1dHRvblwiXScpO1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgdGFnIHdhcyBjcmVhdGVkXG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCd0ZXh0PUUyRSBUZXN0IFRhZycpKS50b0JlVmlzaWJsZSgpO1xuICAgICAgXG4gICAgICAvLyBUZXN0IHRhZyBlZGl0aW5nXG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdbZGF0YS10ZXN0aWQ9XCJ0YWctbWVudS1FMkUgVGVzdCBUYWdcIl0nKTtcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ3RleHQ9RWRpdGFyJyk7XG4gICAgICBhd2FpdCBwYWdlLmZpbGwoJ1tkYXRhLXRlc3RpZD1cImVkaXQtdGFnLW5hbWVcIl0nLCAnVXBkYXRlZCBFMkUgVGFnJyk7XG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdbZGF0YS10ZXN0aWQ9XCJzYXZlLXRhZy1lZGl0XCJdJyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0YWcgd2FzIHVwZGF0ZWRcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ3RleHQ9VXBkYXRlZCBFMkUgVGFnJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgYnVsayBvcGVyYXRpb25zXG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdbZGF0YS10ZXN0aWQ9XCJzZWxlY3QtdGFnLVVwZGF0ZWQgRTJFIFRhZ1wiXScpO1xuICAgICAgYXdhaXQgcGFnZS5jbGljaygnW2RhdGEtdGVzdGlkPVwiYnVsay1kZWxldGUtYnV0dG9uXCJdJyk7XG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdbZGF0YS10ZXN0aWQ9XCJjb25maXJtLWJ1bGstZGVsZXRlXCJdJyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0YWcgd2FzIGRlbGV0ZWRcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ3RleHQ9VXBkYXRlZCBFMkUgVGFnJykpLm5vdC50b0JlVmlzaWJsZSgpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnc2hvdWxkIHByb3ZpZGUgYW5hbHl0aWNzIGFuZCB1c2FnZSBzdGF0aXN0aWNzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgYXdhaXQgcGFnZS5nb3RvKCcvZGFzaGJvYXJkJyk7XG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdidXR0b246aGFzLXRleHQoXCJUYWdzXCIpJyk7XG4gICAgICBcbiAgICAgIC8vIE9wZW4gYW5hbHl0aWNzIG1vZGFsXG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdbZGF0YS10ZXN0aWQ9XCJ0YWctYW5hbHl0aWNzLWJ1dHRvblwiXScpO1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgYW5hbHl0aWNzIG1vZGFsIGlzIGRpc3BsYXllZFxuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwidGFnLWFuYWx5dGljcy1tb2RhbFwiXScpKS50b0JlVmlzaWJsZSgpO1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgYW5hbHl0aWNzIGNvbnRlbnRcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cIm1vc3QtdXNlZC10YWdzXCJdJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJ1c2FnZS1zdGF0aXN0aWNzXCJdJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgYW5hbHl0aWNzIGRhdGEgdmlzdWFsaXphdGlvblxuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwidXNhZ2UtY2hhcnRcIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdC5kZXNjcmliZSgnQXV0by1TdWdnZXN0aW9ucyBTeXN0ZW0nLCAoKSA9PiB7XG4gICAgdGVzdCgnc2hvdWxkIHByb3ZpZGUgaW50ZWxsaWdlbnQgdGFnIHN1Z2dlc3Rpb25zIGluIFNjcmlwdEZvcm0nLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBwYWdlLmdvdG8oJy9nZW5lcmF0b3InKTtcbiAgICAgIFxuICAgICAgLy8gRmlsbCBmb3JtIHRvIHRyaWdnZXIgc3VnZ2VzdGlvbnNcbiAgICAgIGF3YWl0IHBhZ2Uuc2VsZWN0T3B0aW9uKCdbZGF0YS10ZXN0aWQ9XCJwbGF0Zm9ybS1zZWxlY3RcIl0nLCAnaW5zdGFncmFtJyk7XG4gICAgICBhd2FpdCBwYWdlLnNlbGVjdE9wdGlvbignW2RhdGEtdGVzdGlkPVwiZm9ybWF0LXNlbGVjdFwiXScsICdyZWVsJyk7XG4gICAgICBhd2FpdCBwYWdlLmZpbGwoJ1tkYXRhLXRlc3RpZD1cInZpZGVvLXRvcGljXCJdJywgJ0NvbW8gZmF6ZXIgdW0gdHV0b3JpYWwgZGUgbWFya2V0aW5nIGRpZ2l0YWwgcGFyYSBpbmljaWFudGVzJyk7XG4gICAgICBhd2FpdCBwYWdlLnNlbGVjdE9wdGlvbignW2RhdGEtdGVzdGlkPVwidmlkZW8tZ29hbFwiXScsICdFZHVjYXIgYXVkacOqbmNpYScpO1xuICAgICAgXG4gICAgICAvLyBXYWl0IGZvciBhdXRvLXN1Z2dlc3Rpb25zIHRvIGFwcGVhclxuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwidGFnLXN1Z2dlc3Rpb25zXCJdJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSBzdWdnZXN0aW9uIHF1YWxpdHlcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cInN1Z2dlc3Rpb24tbWFya2V0aW5nXCJdJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJzdWdnZXN0aW9uLWVkdWNhdGlvbmFsXCJdJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgYXBwbHlpbmcgc3VnZ2VzdGlvbnNcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cInN1Z2dlc3Rpb24tbWFya2V0aW5nXCJdJyk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0YWcgd2FzIGFwcGxpZWRcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cInNlbGVjdGVkLXRhZy1tYXJrZXRpbmdcIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICAgIFxuICAgICAgLy8gVGVzdCBjb25maWRlbmNlIHNjb3JpbmdcbiAgICAgIGNvbnN0IGNvbmZpZGVuY2VUZXh0ID0gYXdhaXQgcGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJzdWdnZXN0aW9uLWNvbmZpZGVuY2VcIl0nKS5maXJzdCgpLnRleHRDb250ZW50KCk7XG4gICAgICBleHBlY3QoY29uZmlkZW5jZVRleHQpLnRvTWF0Y2goL1xcZCslLyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgdXBkYXRlIHN1Z2dlc3Rpb25zIGJhc2VkIG9uIHBsYXRmb3JtIGNoYW5nZXMnLCBhc3luYyAoKSA9PiB7XG4gICAgICBhd2FpdCBwYWdlLmdvdG8oJy9nZW5lcmF0b3InKTtcbiAgICAgIFxuICAgICAgLy8gRmlsbCBpbml0aWFsIGNvbnRlbnRcbiAgICAgIGF3YWl0IHBhZ2UuZmlsbCgnW2RhdGEtdGVzdGlkPVwidmlkZW8tdG9waWNcIl0nLCAnUHJvZmVzc2lvbmFsIG5ldHdvcmtpbmcgdGlwcycpO1xuICAgICAgXG4gICAgICAvLyBTZWxlY3QgTGlua2VkSW4gcGxhdGZvcm1cbiAgICAgIGF3YWl0IHBhZ2Uuc2VsZWN0T3B0aW9uKCdbZGF0YS10ZXN0aWQ9XCJwbGF0Zm9ybS1zZWxlY3RcIl0nLCAnbGlua2VkaW4nKTtcbiAgICAgIFxuICAgICAgLy8gV2FpdCBmb3IgcGxhdGZvcm0tc3BlY2lmaWMgc3VnZ2VzdGlvbnNcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cInRhZy1zdWdnZXN0aW9uc1wiXScpKS50b0JlVmlzaWJsZSgpO1xuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcigndGV4dD1wcm9maXNzaW9uYWwnKSkudG9CZVZpc2libGUoKTtcbiAgICAgIFxuICAgICAgLy8gQ2hhbmdlIHRvIEluc3RhZ3JhbVxuICAgICAgYXdhaXQgcGFnZS5zZWxlY3RPcHRpb24oJ1tkYXRhLXRlc3RpZD1cInBsYXRmb3JtLXNlbGVjdFwiXScsICdpbnN0YWdyYW0nKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IHN1Z2dlc3Rpb25zIHVwZGF0ZWRcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ3RleHQ9c3RvcnknKSkudG9CZVZpc2libGUoKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgdGVzdC5kZXNjcmliZSgnUGVyZm9ybWFuY2UgYW5kIFVzZXIgRXhwZXJpZW5jZScsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgbWVldCBwZXJmb3JtYW5jZSBiZW5jaG1hcmtzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gTWVhc3VyZSBwYWdlIGxvYWQgdGltZVxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICAgIGF3YWl0IHBhZ2UuZ290bygnL2Rhc2hib2FyZCcpO1xuICAgICAgYXdhaXQgcGFnZS53YWl0Rm9yTG9hZFN0YXRlKCduZXR3b3JraWRsZScpO1xuICAgICAgY29uc3QgbG9hZFRpbWUgPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xuICAgICAgXG4gICAgICAvLyBEYXNoYm9hcmQgc2hvdWxkIGxvYWQgd2l0aGluIDIgc2Vjb25kc1xuICAgICAgZXhwZWN0KGxvYWRUaW1lKS50b0JlTGVzc1RoYW4oMjAwMCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgbGF6eSBsb2FkaW5nIHBlcmZvcm1hbmNlXG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdidXR0b246aGFzLXRleHQoXCJUYWdzXCIpJyk7XG4gICAgICBjb25zdCB0YWdMb2FkU3RhcnQgPSBEYXRlLm5vdygpO1xuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcignW2RhdGEtdGVzdGlkPVwidGFnLW1hbmFnZXJcIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICAgIGNvbnN0IHRhZ0xvYWRUaW1lID0gRGF0ZS5ub3coKSAtIHRhZ0xvYWRTdGFydDtcbiAgICAgIFxuICAgICAgLy8gTGF6eSBsb2FkZWQgY29tcG9uZW50cyBzaG91bGQgYXBwZWFyIHdpdGhpbiA1MDBtc1xuICAgICAgZXhwZWN0KHRhZ0xvYWRUaW1lKS50b0JlTGVzc1RoYW4oNTAwKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ3Nob3VsZCBwcm92aWRlIHJlc3BvbnNpdmUgZGVzaWduIGFjcm9zcyBkZXZpY2VzJywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gVGVzdCBtb2JpbGUgdmlld3BvcnRcbiAgICAgIGF3YWl0IHBhZ2Uuc2V0Vmlld3BvcnRTaXplKHsgd2lkdGg6IDM3NSwgaGVpZ2h0OiA2NjcgfSk7XG4gICAgICBhd2FpdCBwYWdlLmdvdG8oJy9kYXNoYm9hcmQnKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IG1vYmlsZS1mcmllbmRseSBsYXlvdXRcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cIm1vYmlsZS1tZW51XCJdJykpLnRvQmVWaXNpYmxlKCk7XG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJkZXNrdG9wLXNpZGViYXJcIl0nKSkubm90LnRvQmVWaXNpYmxlKCk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgdGFibGV0IHZpZXdwb3J0XG4gICAgICBhd2FpdCBwYWdlLnNldFZpZXdwb3J0U2l6ZSh7IHdpZHRoOiA3NjgsIGhlaWdodDogMTAyNCB9KTtcbiAgICAgIGF3YWl0IHBhZ2UucmVsb2FkKCk7XG4gICAgICBcbiAgICAgIC8vIFZlcmlmeSB0YWJsZXQgbGF5b3V0XG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJyZXNwb25zaXZlLWdyaWRcIl0nKSkudG9IYXZlQ2xhc3MoL21kOmdyaWQtY29scy0yLyk7XG4gICAgICBcbiAgICAgIC8vIFRlc3QgZGVza3RvcCB2aWV3cG9ydFxuICAgICAgYXdhaXQgcGFnZS5zZXRWaWV3cG9ydFNpemUoeyB3aWR0aDogMTkyMCwgaGVpZ2h0OiAxMDgwIH0pO1xuICAgICAgYXdhaXQgcGFnZS5yZWxvYWQoKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IGRlc2t0b3AgbGF5b3V0XG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJyZXNwb25zaXZlLWdyaWRcIl0nKSkudG9IYXZlQ2xhc3MoL2xnOmdyaWQtY29scy0zLyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCdzaG91bGQgaGFuZGxlIGVycm9yIHN0YXRlcyBncmFjZWZ1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gU2ltdWxhdGUgbmV0d29yayBlcnJvclxuICAgICAgYXdhaXQgcGFnZS5yb3V0ZSgnKiovYXBpLyoqJywgcm91dGUgPT4gcm91dGUuYWJvcnQoKSk7XG4gICAgICBcbiAgICAgIGF3YWl0IHBhZ2UuZ290bygnL2Rhc2hib2FyZCcpO1xuICAgICAgXG4gICAgICAvLyBWZXJpZnkgZXJyb3IgaGFuZGxpbmdcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cImVycm9yLW1lc3NhZ2VcIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cInJldHJ5LWJ1dHRvblwiXScpKS50b0JlVmlzaWJsZSgpO1xuICAgICAgXG4gICAgICAvLyBUZXN0IHJldHJ5IGZ1bmN0aW9uYWxpdHlcbiAgICAgIGF3YWl0IHBhZ2UudW5yb3V0ZSgnKiovYXBpLyoqJyk7XG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdbZGF0YS10ZXN0aWQ9XCJyZXRyeS1idXR0b25cIl0nKTtcbiAgICAgIFxuICAgICAgLy8gVmVyaWZ5IHJlY292ZXJ5XG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJkYXNoYm9hcmQtY29udGVudFwiXScpKS50b0JlVmlzaWJsZSgpO1xuICAgIH0pO1xuICB9KTtcblxuICB0ZXN0LmRlc2NyaWJlKCdJbnRlZ3JhdGlvbiBXb3JrZmxvdycsICgpID0+IHtcbiAgICB0ZXN0KCdzaG91bGQgY29tcGxldGUgZnVsbCB1c2VyIHdvcmtmbG93JywgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gMS4gTmF2aWdhdGUgdG8gZGFzaGJvYXJkXG4gICAgICBhd2FpdCBwYWdlLmdvdG8oJy9kYXNoYm9hcmQnKTtcbiAgICAgIFxuICAgICAgLy8gMi4gQ3JlYXRlIGFuZCBhcHBseSBmaWx0ZXIgcHJlc2V0XG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdidXR0b246aGFzLXRleHQoXCJQcm9qZXRvc1wiKScpO1xuICAgICAgYXdhaXQgcGFnZS5jbGljaygnW2RhdGEtdGVzdGlkPVwiZXhwYW5kLWZpbHRlcnNcIl0nKTtcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cInBsYXRmb3JtLWluc3RhZ3JhbVwiXScpO1xuICAgICAgYXdhaXQgcGFnZS5jbGljaygnW2RhdGEtdGVzdGlkPVwic2F2ZS1wcmVzZXQtdHJpZ2dlclwiXScpO1xuICAgICAgYXdhaXQgcGFnZS5maWxsKCdbZGF0YS10ZXN0aWQ9XCJwcmVzZXQtbmFtZS1pbnB1dFwiXScsICdJbnN0YWdyYW0gQ29udGVudCcpO1xuICAgICAgYXdhaXQgcGFnZS5jbGljaygnW2RhdGEtdGVzdGlkPVwic2F2ZS1wcmVzZXQtY29uZmlybVwiXScpO1xuICAgICAgXG4gICAgICAvLyAzLiBOYXZpZ2F0ZSB0byB0YWcgbWFuYWdlbWVudFxuICAgICAgYXdhaXQgcGFnZS5jbGljaygnYnV0dG9uOmhhcy10ZXh0KFwiVGFnc1wiKScpO1xuICAgICAgYXdhaXQgcGFnZS5jbGljaygnW2RhdGEtdGVzdGlkPVwiY3JlYXRlLXRhZy1idXR0b25cIl0nKTtcbiAgICAgIGF3YWl0IHBhZ2UuZmlsbCgnW2RhdGEtdGVzdGlkPVwidGFnLW5hbWUtaW5wdXRcIl0nLCAnQ29udGVudCBTdHJhdGVneScpO1xuICAgICAgYXdhaXQgcGFnZS5jbGljaygnW2RhdGEtdGVzdGlkPVwic2F2ZS10YWctYnV0dG9uXCJdJyk7XG4gICAgICBcbiAgICAgIC8vIDQuIENyZWF0ZSBuZXcgcHJvamVjdCB3aXRoIGF1dG8tc3VnZ2VzdGlvbnNcbiAgICAgIGF3YWl0IHBhZ2UuZ290bygnL2dlbmVyYXRvcicpO1xuICAgICAgYXdhaXQgcGFnZS5zZWxlY3RPcHRpb24oJ1tkYXRhLXRlc3RpZD1cInBsYXRmb3JtLXNlbGVjdFwiXScsICdpbnN0YWdyYW0nKTtcbiAgICAgIGF3YWl0IHBhZ2UuZmlsbCgnW2RhdGEtdGVzdGlkPVwidmlkZW8tdG9waWNcIl0nLCAnQ29udGVudCBzdHJhdGVneSBmb3Igc21hbGwgYnVzaW5lc3NlcycpO1xuICAgICAgXG4gICAgICAvLyA1LiBBcHBseSBhdXRvLXN1Z2dlc3RlZCB0YWdzXG4gICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCdbZGF0YS10ZXN0aWQ9XCJ0YWctc3VnZ2VzdGlvbnNcIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cInN1Z2dlc3Rpb24tY29udGVudC1zdHJhdGVneVwiXScpO1xuICAgICAgXG4gICAgICAvLyA2LiBHZW5lcmF0ZSBzY3JpcHRcbiAgICAgIGF3YWl0IHBhZ2UuY2xpY2soJ1tkYXRhLXRlc3RpZD1cImdlbmVyYXRlLXNjcmlwdC1idXR0b25cIl0nKTtcbiAgICAgIFxuICAgICAgLy8gNy4gVmVyaWZ5IHdvcmtmbG93IGNvbXBsZXRpb25cbiAgICAgIGF3YWl0IGV4cGVjdChwYWdlLmxvY2F0b3IoJ1tkYXRhLXRlc3RpZD1cImdlbmVyYXRlZC1zY3JpcHRcIl0nKSkudG9CZVZpc2libGUoKTtcbiAgICAgIFxuICAgICAgLy8gOC4gUmV0dXJuIHRvIGRhc2hib2FyZCBhbmQgdmVyaWZ5IHByb2plY3QgYXBwZWFyc1xuICAgICAgYXdhaXQgcGFnZS5nb3RvKCcvZGFzaGJvYXJkJyk7XG4gICAgICBhd2FpdCBwYWdlLmNsaWNrKCdidXR0b246aGFzLXRleHQoXCJQcm9qZXRvc1wiKScpO1xuICAgICAgYXdhaXQgZXhwZWN0KHBhZ2UubG9jYXRvcigndGV4dD1Db250ZW50IHN0cmF0ZWd5JykpLnRvQmVWaXNpYmxlKCk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIHRlc3QuYWZ0ZXJFYWNoKGFzeW5jICgpID0+IHtcbiAgICBhd2FpdCBwYWdlLmNsb3NlKCk7XG4gIH0pO1xufSk7ICJdLCJ2ZXJzaW9uIjozfQ==